%!TEX root = thesis.tex
\chapter{Magnetic springs}

\chapterprecis{
  This chapter uses the theory presented earlier to discuss simple
  permanent magnetic systems and how they can be used in spring-like fashions.
  First cover various arrangements that produce forces in one direction or
  another, keeping track of where the stabilities and instabilities are in the
  translational degrees of freedom. This is followed by a discussion on
  rotational stability; this is more of a design problem as geometric placement
  of the magnets has more influence.
  In the second half of the chapter I digress on forces between a magnet and a coil;
  this has relevance to the later experimental rig design and demonstrates an
  application of the theory outlined in \chapref{magnet-theory}.
}

\epigraph{As the weaver elaborated his pattern for no end but the
pleasure of his aesthetic sense, so might a man live his life, or if one
was forced to believe that his actions were outside his choosing, so might
a man look at his life, that it made a pattern. There was as little need
to do this as there was use. It was merely something he did for his own
pleasure.}{\textcite{maugham1915}}

\section{Introduction}

The force created between permanent magnets can be used in various ways for supporting load.
This chapter investigates a number of different configurations, some of which having been used to various degrees in the literature.
Varieties in design lend themselves for different purposes, such as optimising for load force, number of directions of instability, and low variability in resonance frequency.


\section{Simple magnet arrangements}

\begin{figure}
  \grf{Figures/Magnets/vspring}
  \caption{Magnets in repulsion create a vertical spring.}
  \figlabel{vspring}
\end{figure}

The most simple example of a magnetic spring can be seen in
\figref{vspring}, with one fixed and one floating magnet arranged
vertically.  With like poles facing, the two magnets repel each other
and produce an air gap between them. Displacement towards each other
is restored by the repulsive magnetic force, and displacement away is
restored by gravity. The floating magnet must be constrained in both
horizontal directions by the shaft. If the contraint is removed, it
will be naturally unstable horizontally due to Earnshaw's theorem (see
\secref{earnshaw}).

A more stable configuration is desired, because the instabilities of
this spring occur in two orthogonal horizontal directions. Inspired by
the rearrangements of radial and thrust bearings shown by
\textcite{yonnet1981}, an improved design is shown in
\figref{hspring}. Now the spring forces are caused by horizontal
magnets in \emph{attraction}, in contrast to the earlier arrangement
shown in \figref{vspring} which uses repulsive force.) Two fixed
outer magnets both attract a centred floating magnet, so the unstable
\dof/ is in that horizontal direction. Perturbations in
the other horizontal direction are restored by the aforementioned
attraction, which is similarly the cause of the positive vertical
spring stiffness. Note that the diagram works as both a top \emph{and}
side view, demonstrating how it is unstable in only one direction.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Magnets/hspringa}
    \caption{At rest, neglecting the magnet weight.}
    \figlabel{hspringa}
  \end{subfigure}
  \begin{subfigure}
    \grf{Figures/Magnets/hspringb}
    \caption{After displacement.}
    \figlabel{hspringb}
  \end{subfigure}
  \caption[`Horizontal' spring.]{A `horizontal' spring with \emph{attracting}
magnets to create vertical stiffness, as shown by the reaction forces after
displacement.}
  \figlabel{hspring}
\end{figure}

The removal of an unstable \dof/ has its consequences,
however.  The forces between magnetic dipoles are inverse-square
functions of the distance between them, and this holds true
approximately for magnets as well. In the vertical spring, the effect
of increased load on the spring is displacement toward the fixed
magnet. This increases the stiffness of the spring.

With the horizontal spring, however, the behaviour is a little more
complex. For the case shown in \figref{hspringa}, the only forces
on the floating magnet are horizontal. The vertical spring force
occurs when the magnet has been displaced as in \figref{hspringb},
which will increase with distance only for a small range. Beyond this,
the force will start \emph{decreasing} as the floating magnet becomes
further enough away from the fixed magnets — at which point the spring
stiffness turns negative and the floating magnet will be unstable.

This parabola effect is shown in \figref{h+v-forces-v}, which also
includes the force curve of the vertical spring. The graph was
produced from a finite element analysis performed by \ANSYS/, using
half-inch neodymium rare-earth cube magnets.
\note{Remanence $B_r=\SI{1.2}{T}$ and coercivity
  $H_c\approx\SI{900}{kA\cdot m^{-1}}$}
The effect of varying the gap between the fixed and floating magnets for the
horizontal spring is also demonstrated; the further away the fixed magnets
are, the weaker the forces are.

\begin{figure}
  \begin{wide}
    \raggedout
    \grf{Figures/Magnets/h+v-forces-v}
    \hfill
    \grf{Figures/Magnets/h+v-springs}
    \hfill
    \null
  \end{wide}
  \caption[Spring forces of the vertical \& horizontal springs.]{Forces from
\FEA\ comparing the simple vertical and horizontal magnetic springs.
The initial gap between the magnets in the vertical spring has been arbitrarily
set to three magnet widths.}
  \figlabel{h+v-forces-v}
\end{figure}

\Figref{hvspring} shows how the two springs discussed so far,
horizontal and vertical, may be combined to reap the benefits of
both. There are now three fixed magnets: one below, which provides the
majority of the stiffness of the spring, and two aside, for
stabilising one \dof/ in the `into the page'
direction. This simple design gives a basic framework from which to
build up more complex arrangements.

\begin{figure}
   \grf{Figures/Magnets/hvspring}
   \caption[Combination vertical/horizontal spring.]{Combination
spring, with the
strength of the vertical spring and the stability of the horizontal spring.}
   \figlabel{hvspring}
\end{figure}


\section{Taxonomy of magnetic springs}

In this section we introduce a variety of \emph{simple} magnetic
springs, with the mind to analyse their behaviour. It is implicit in
Earnshaw's theorem \cite{earnshaw1842} (elucidated by Tonks
\cite{tonks1940}) that all permanent magnet suspensions cannot be
stable, so the one of the factors involved in analysing the efficacy
of a magnetic spring is its degree of stability.

Earnshaw established the relation for purely magnetic systems
\begin{dmath*} k_x+k_y+k_z=0; \end{dmath*}
that is, the translatory stiffesses in each direction sum to
zero. (Define the vertical in the $z$ direction.) Introducing soft
iron into the system changes the relation to summing to \emph{less
  than} zero, reducing the stability of the system.

Various systems can be created with different arrangements of magnets
and combinations thereof. Seven spring configurations are examined here:
\begin{itemize}
\item Unstable vertical ($k_z<0,k_x=k_y=-\half k_z>0$)
\item Stable vertical ($k_z>0,k_x=k_y=-\half k_z<0$)
\item Vertical double stable ($k_z>0,k_x>0,k_y<0$)
\item Quasi--zero stiffness ($k_x=k_y=k_z=0$)
\item Horizontal ($k_x<0,k_y=k_z=-\half k_x>0$)
\item Vertical zero stiffness ($k_z=0,k_y=-k_x>0$)
\end{itemize}
These springs are detailed as follows.

The most common magnetic suspension for demonstrating nonlinear
control design is the unstable vertical arrangement, in which a fixed
upper magnets applies a gravity-cancelling force on a lower magnet in
attraction. This design is unstable and thus has a negative
stiffness. Although it is unstable in only a single \dof/,
it is inconvenient to bear loads with a negative stiffness spring.

The opposite of the unstable vertical spring is the stable vertical
spring, consisting of a fixed lower magnet supporting a floating upper
magnet in repulsion. Here, there is a positive spring stiffness in the
vertical, load bearing direction. However, it experiences multiple
degrees of instability in the horizontal directions, which complicates
its stabilisation.

Using two fixed lower magnets, slightly offset, instead of one in the
vertical stable configuration produces a `double stable' spring with a
limited range of stability also in the direction of separation between
the fixed magnets. Much smaller forces are possible with this setup.

A very interesting system is produced when the two vertical springs
are combined; this is termed the zero stiffness spring. With a
positive vertical stiffness in series with a negative stiffness, the
local minimum in the force/displacement curve creates a marginally
stable point of zero stiffness. With greater displacements, the upper
attractive magnet can be used to simply \emph{reduce} the natural
frequency of the system without driving it to zero; this improves
vibration isolation characteristics without altering the stability of
the system (given bounded displacements). This is the configuration
used by \textcite{challa2008} in their tunable vibration energy
harvesting device.

Stability in the vertical direction with only a single degree of
instability can be achieved with a horizontal arrangement of magnets
in attraction. Here, the load bearing force is mirrored in one
horizontal direction, although the forces involved are smaller than
with the vertical arrangements.

This horizontal spring can be augmented with the stable vertical
spring in order to increase its load bearing capacity. This does not
compromise the stability achieved in the out of plane horizontal
direction.

Finally, the horizontal and zero stiffness springs can produce a
spring approaching zero stiffness in the vertical direction, a small positive
stiffness in one horizontal direction, and an equal negative stiffness
in the other.

\subsection{Other magnet arrangements}

This covers only a small selection of possible permanent magnet
configurations, but it does highlight the important variations in
behaviour possible. To enumerate the different cases, we have:
\begin{enumerate}
\item positive stiffness in two horizontal directions;
\item negative stiffness in two horizontal directions;
\item zero stiffness in all directions;
\item negative stiffness in one horizontal direction; and,
\item zero stiffness in one direction;
\end{enumerate}

\textcite{choi2003} designed a levitation table capable of supporting \SI{15}{kg} that is unstable in only one horizontal \dof/.
However, the magnetic arrangement used for the spring, despite their claims, appears quite unstable and is not suited for scaling up to bear greater loads.
Their experiments prove that only a single axis requires control for stability, but the position resolution they achieve is fairly coarse.

\section{Analyses of magnetic springs}

Magnetic node tests of a simple zero stiffness
spring~\cite{nijsse2001}, depicted in
\figref{zero-stiffness-spring}, with three half-inch cube magnets
gives expected results for vertical load bearing, shown in
\figref{zspring-vary-gap}. The displacement is shown over the full
range of vertical gap. The spring is marginally stable in both
horizontal directions, however, which is less convenient.
\begin{figure}
  \centering
  \grf{Figures/Systems/zero-stiffness-spring}
  \caption{`Zero stiffness' spring schematic.}
  \figlabel{zero-stiffness-spring}
\end{figure}

\begin{figure}
  \centering
  \grf{Simulations/Single_magnets/z_spring/eps/zspring-vary-gap}
  \caption{`Zero stiffness' spring forces \vs\ vertical displacement}
  \figlabel{zspring-vary-gap}
\end{figure}

\begin{figure}
  \centering
  \grf{Simulations/Single_magnets/z_spring/eps/zspring-2d-yforces}
  \grf{Simulations/Single_magnets/z_spring/eps/zspring-2d-zforces}
  \caption{`Zero stiffness' spring forces \vs\ displacement in two orthogonal directions}
  \figlabel{zspring-forces}
\end{figure}



Well, the logical next step after analysing the zero stiffness spring
is to combine it with my previous spring, the combined
horizontal/vertical spring with a single degree of translational
instability. This is shown in \figref{zhv-spring}.

\begin{figure}
   \centering
   \grf{Figures/Systems/zhv-spring}
   \caption{Co-ordinate system of the `ZHV' spring. The \y\ direction is into the page.}
   \figlabel{zhv-spring}
\end{figure}

These tests are more sophisticated that the zero-stiffness tests,
because the effect of load on the spring was neglected in the previous
case. For these following tests, there are five Newtons of force
applied by gravity, which has the effect of removing the symmetry for
some of the graphs. There is a single magnet dimension gap between the
spring magnet and all fixed magnets.

The first three tests are shown in
\figref{zhvspring-move-x,zhvspring-move-y,zhvspring-move-z} for motion
around the centred position in the three orthogonal directions. As
expected, this spring combines the properties of both simpler springs
used to create it. Zero stiffness can be achieved at a point of
marginal stability. This hasn't changed, although the graph is more
realistic since it assumes a non-zero load on the spring.

It can also be seen that horizontal motions in both directions reduce
the vertical force on the spring. This means that for disturbances in
these horizontal directions, there will be coupling with the vertical
direction.

\begin{figure}
   \centering
   \grf{Simulations/Single_magnets/5_magnet_spring/eps/zhvspring-move-x}
   \caption{Forces on the ZHV spring for displacement in the \x\ direction.}
   \figlabel{zhvspring-move-x}
\end{figure}

\begin{figure}
   \centering
   \grf{Simulations/Single_magnets/5_magnet_spring/eps/zhvspring-move-y}
   \caption{Forces on the ZHV spring for displacement in the \y\ direction.}
   \figlabel{zhvspring-move-y}
\end{figure}

\begin{figure}
   \centering
   \grf{Simulations/Single_magnets/5_magnet_spring/eps/zhvspring-move-z}
   \caption{Individual and combined vertical forces on the ZHV spring for
   displacement in the \z\ direction. For this case of $\x=\y=0$, all
   horizontal forces are zero.}
   \figlabel{zhvspring-move-z}
\end{figure}

Moving the spring in two directions simultaneously gives a better
picture of the stability of the spring. For example, motion in the
\x-direction showns zero force in the \y, and vice versa. But motion
in both? The behaviour is more complex than shown here.

However, marginal stability in the vertical direction is the same
behaviour as a spring magnet levitating below a fixed attractive
magnet, which I rejected because I like vertical stability. So there
needs to not be a contradiction in my choices here. I expect that I
will use a vertically attracting magnet to simply \emph{reduce} the
effective mass of the spring, rather than bring it all the way down to
the zero stiffness state. This can be experimented with.

\section{Isosurfaces of stability}
\seclabel{all-springs-forces}

I have managed to plot the three dimensional forces and stiffness of
the zero-stiffness \x-unstable spring in three dimensional space. This
will be useful in comparing the stability characteristics between
different spring configurations. While relatively simple now, these
plots will look a more complex when multipole arrays are used to
generate the magnetic forces. See \figref{zhvspring-move-z-iso}.

\begin{figure}
   \centering
   \grf{Simulations/Single_magnets/5_magnet_spring/eps/zhv-xforces}
   \caption{\x-direction isoforces on the ZHV spring.}
   \figlabel{zhvspring-move-z-iso}
\end{figure}

Using these \threeD/ forces over a range of \threeD/ displacements, I have
also plotted force and stiffness isosurfaces (\ie, surfaces of constant
force/stiffness), using transparency to see what is going on.

Having now created a method to plot three dimensional results, I then combined
all of the code for examining the forces on each of my simple single magnet
springs. Since the method is simply the superposition of forces for various
arrangements of magnets, the individual results can be broken out and examined
separately.

\subsubsection{Vertically attracting spring}

We start out by looking at the simple configuration often used in the
literature: the spring magnet floating beneath a fixed attractive support
magnet. This spring is stable in both horizontal directions, but unstable in
the vertical direction.

First examine the forces on the floating spring as locations beneath the
support, shown in \figref{vattr-forces}. No legend makes this a bit confusing,
but the colour scale goes through the spectrum red to blue as the forces
increase. For symmetrical cases like the \x- and \y-direction forces, this
makes pale green-blue the colour of zero force, with orange/purple the
negative and positive extremes, respectively.

So, in the case of the \x-forces, we see that positive motion in the
x-direction results in a force in the negative direction; \ie, the force
opposes the displacement. Similarly for the \y-direction. As is expected, in
the \z-direction, we see that the closer the spring magnet comes to the
attractive magnet vertically, the greater the forces in that direction. This
is instability.

\newcommand\isoforces[2]{%
  \begin{figure}
    \begin{wide}
      \centering
      \grf{Simulations/Single_magnets/all_springs/eps_nice/#1-xforce}
      \grf{Simulations/Single_magnets/all_springs/eps_nice/#1-yforce}
      \grf{Simulations/Single_magnets/all_springs/eps_nice/#1-zforce}
    \end{wide}
    \caption{#2}
    \figlabel{#1-forces}
  \end{figure}
}
\newcommand\isostiffnesses[2]{%
  \begin{figure}
    \begin{wide}
      \centering
      \grf{Simulations/Single_magnets/all_springs/eps_nice/#1-xstiffness}
      \grf{Simulations/Single_magnets/all_springs/eps_nice/#1-ystiffness}
      \grf{Simulations/Single_magnets/all_springs/eps_nice/#1-zstiffness}
    \end{wide}
    \caption{#2}
    \figlabel{#1-stiffnesses}
  \end{figure}
}

\isoforces{vattr}{Isosurface forces of the attracting vertical spring}

The stability regions are shown more clearly in the stiffness plots. We know
that instability occurs in regions of positive gradient of the force curve.
This is negative stiffness: the resulting force does not oppose the
displacement that causes it. For the stiffness isosurfaces, \emph{only}
regions of negative stiffness are shown, beginning with red at the region of
zero stiffness, the region of marginal stability. Let's have a look at
\figref{vattr-stiffnesses}.

\isostiffnesses{vattr}
  {Negative isosurface stiffnesses of the attracting vertical spring.}

We see that in both horizontal directions, there is a wide region of stability
shown by the absence of negative isosurfaces. In the vertical direction, we
see that the stiffness is negative for all reasonable locations of the spring.

With this simple spring, we have shown the force and stiffness isosurfaces.
From these curves, we can easily deduce the regions of stability through the
negative stiffness isosurfaces.

\subsubsection{Vertically repelling spring}

While time is pressing, I'll now simply enumerate through the graphs produced
with minimal explanation. Look to the future for more description.

The simple positive vertical-stiffness spring is covered next. Here we have
the opposite of the vertically attracting spring: the spring magnet is
supported \emph{above} a fixed magnet in repulsion. Here we have vertical
stability only, with both horizontal directions marginally stable in the
centred position. See \figref{vrepl-stiffnesses}.

\isostiffnesses{vrepl}
  {Negative isosurface stiffnesses of the repelling vertical spring.}

\subsubsection{Zero stiffness spring}

The zero stiffness spring was a new development. It is a superposition of the
previous two springs, so we have a vertically attractive magnet above our
spring magnet, and a vertically repulsive magnet below. Now, half way in
between their effects will cancel out, producing equal force up and down on
the magnet. If the magnet is supporting load, this creates a `zero stiffness'
configuration below the centre point where, theoretically, the spring forces
is de-coupled from its displacement. Now, the spring is unstable above this
point, so it would require a stabilising control system to work in practise,
but it's an interesting idea.

\isostiffnesses{z}
  {Negative isosurface stiffnesses of the zero stiffness spring.}

\subsubsection{Horizontal spring}

The horizontal spring is composed of two fixed magnets supporting the spring
magnet between them in the \x-direction in attraction. The stability is in
both \y- and \z-direction, instability in \x.

\isostiffnesses{h}
  {Negative isosurface stiffnesses of the horizontal spring.}

\subsubsection{Horizontal spring with vertical support}

Due to the previous spring's lack of significant loading bearing ability, it
can be bolstered by adding a vertically repulsive magnet below the spring
magnet. This is a superposition of the horizontal, and vertically repulsive
springs. We should see similar stability curves to the horizontal spring
without support.

\isostiffnesses{hv}
  {Negative isosurface stiffnesses of the horizontal spring with support.}

\subsubsection{Horizontal spring with zero stiffness}

Okay, if zero stiffness is so good then we may as well use it in combination
with the horizontal spring to provide greater horizontal stability. This is
the culmination of each design, and theoretically provides the advantages of
each design before it: the reduced resonance of the zero stiffness spring, the
large loading bearing support, and the one direction of instability that makes
it easier to control. We'll see how it works out in the experiments\dots.

\isostiffnesses{zhv}
  {Negative isosurface stiffnesses of the zero stiffness horizontal spring.}


\subsubsection{Single-instability spring}

\cite{choi2003}. \fxfatal{missing}



\section{Rotational degrees of freedom}

It becomes more difficult to examine the behaviour of these systems in
six degrees of freedom. There is no ``Earnshaw's Theorem'' to neatly
relate the rotational stiffnesses. Equilibria of a system with that
have rotational instabilities can be stabilised by coupling together
identical systems. An example is the vertically stable spring, which
is unstable around the $x$, $y$ directions. A trio of these springs
connected rigidly is now \emph{stable} in these rotational directions.

Such conveniences make it possible to design a system with a single
degree of instability. An axial bearing designed in such a manner has
been presented by some people [citation]. Here, a non-contact magnetic
spring is designed with similar principles.

The augmented horizontal spring is used as a basis, as the least
unstable spring presented thus far with a positive vertical
stiffness. For point load support, this spring is unstable both in the
$y$-direction and around the $x$-direction. For planar load support,
with a coupled set of these springs, the instability is now in $y$-direction
(as before) and around the $z$-direction (in contrast). The
method of eliminating one of these rotational instabilities involves
adding supplementary weak magnets that apply small translational
forces to the structure with large `lever arms' (orthogonal distance
to the centre of rotation), such that the added translation stiffness
is negligible but the added rotational stiffness is significant and
stabilising.


\section{Rotationally stable spring}

Previously I have shown a variety of magnetic springs with various
amounts of instability. With rotation degrees of freedom more pliable
in their stability properties it is interesting to attempt to produce
a `minimally unstable' magnetic spring. It is possible to produce a
magnetic arrangement that is stable in all three rotational degrees of
freedom and unstable in but a single translational \dof/.

Unlike `Earnshaw's theorem', which is unequivocal about the
translational stabilities of a magnetic arrangement, no conclusive
statements can be made about a magnetic system's \emph{rotational}
stabilities. This is due to the intrinsic coupling between moment and
geometry; as shown below, it is possible to exploit geometry to
stabilise a magnetic system in all rotational degrees of freedom.

The main idea is that a magnetic system can be
stabilised in all but one translational direction, and
supplementary magnets can be added to the design to stabilise the
rotation directions.

\textcite{delamare1994} performed something similar to remove the
rotational instability of a radial magnetic bearing by adding a
weaker, \emph{axial} bearing to the system—\ie, opposite in effect
to the main aims of the system. The coupling of the axial and radial
bearings eliminates the rotational instability, but the strength of
the radial bearing bearing overpowers the axial bearing for normal
operation.

This is more easily explained with a
diagram. \Figref{delamare} shows how this idea can be applied to a
simplified model.
Attracting magnets close to the centre of rotation
provide the forces for the spring (refer to
\figref{hspring}). Further away, \emph{repelling} magnets are
placed such that the translational forces they apply are \emph{less}
than the attractive forces of the inner magnets (see
\figref{delamare-forces}). However. their strengths and distances
away have been carefully chosen so that the \emph{rotational} forces
(moments) they apply are \emph{greater} than the moments applied by
the inner magnets (see \figref{delamare-moments}). The system my be
represented by the following equations for each equal and opposite
magnet pair. For the forces:
\begin{dgroup}
\begin{dmath}
  F_{\text{total}} = F_{\text{inner}} - F_{\text{outer}}
\end{dmath},
\begin{dmath}
  F_{\text{inner}} > F_{\text{outer}}  \condition{because $d  > D$}
\end{dmath},
\intertext{therefore,}
\begin{dmath}
  F_{\text{total}} > 0
\end{dmath}.
\end{dgroup}
And for the moments:
\begin{dgroup}
\begin{dmath}
  M_{\text{total}} = - M_{\text{inner}} + M_{\text{outer}}
\end{dmath},
\begin{dmath}
  M_{\text{total}} = - r F_{\text{inner}} + R F_{\text{outer}}
\end{dmath},
\begin{dmath}
  R\cdot F_{\text{outer}} >  r\cdot F_{\text{inner}}
  \condition{for $M_{\text{total}} > 0$}
\end{dmath},
\intertext{therefore,}
\begin{dmath}
  \frac Rr > \frac{F_{\text{inner}}}{F_{\text{outer}}}
\end{dmath}.
\end{dgroup}
With appropriate choices of $d$, $D$, $r$, and~$R$, this condition may
be satisfied. Bear in mind, of course, that to first order $F \propto d^2$,
so the
ratio between $r$~and $R$ will need to be significantly greater than
that between $d$~and $D$.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Bearings/delamare-forces}
    \caption{
     The added magnets are spaced farther away,
     so they do not affect the
     translational stability.
     \figlabel{delamare-forces}}
  \end{subfigure}
  \begin{subfigure}
    \grf{Figures/Bearings/delamare-moments}
    \caption{
      The added magnets \emph{do} affect the radial stability
      because their distance from the centre of rotation is much greater.
      \figlabel{delamare-moments}}
  \end{subfigure}
  \caption{Secondary (outer) magnets may be added to add stability
      in the rotational direction.}
  \figlabel{delamare}
\end{figure}

A magnet spring can be designed along such principles such as shown in
approximation in \figref{example-8-mag-spring}, which shows a top-down view.

\begin{figure}
  \asyinclude{PhD/Figures/Systems/magrotate.asy}
  \caption{Schematic of a single unstable \dof/ concept.}
  \figlabel{example-8-mag-spring}
\end{figure}

The translational stability of the system can be assessed using the theory between parallel cuboid magnets (crossref).
In order to model the rotational stability, a measure must be calculated of the torque on the spring design due to rotations around each axis.
Forces in three directions can only be calculated for parallel magnets, and while there are expressions in the literature to calculate the torques between cuboid magnets, these expressions only apply for parallel magnets (\ie, magnets that have no relative rotation between them).
Furthermore, the moments produced by the magnets at their lever arms around the centre of gravity of the spring are likely to dominate over the torque induced between each pair of magnets, since the rotations will be small but the lever arms will be (relatively) large.
Finally, if small rotations of the spring are assumed, then the effect of this rotation on the forces between the magnets can be neglected; the assumption is that for the purposes of force calculation, the magnets will remain parallel to each other.

\begin{figure}
  \begin{wide}
    \begin{subfigure}[0.4]
      \asyinclude{PhD/Figures/Systems/magrotate2.asy}
      \caption{After rotation.}
    \end{subfigure}\hfil
    \begin{subfigure}[0.4]
      \asyinclude{PhD/Figures/Systems/magrotate3.asy}
      \caption{Small-angle approximation for calculating forces and moments.}
    \end{subfigure}
  \end{wide}
  \caption{}
  \figlabel{magrotate}
\end{figure}

The total torque on a system such as shown in \figref{example-8-mag-spring} is therefore calculated by neglecting the torques between the magnets and by neglecting the effects of rotation on the forces between the magnets.

A static analysis of forces and torques created in this magnetic spring was performed using the geometry shown in \figref{magrotate-schem}. For this analysis, cube magnets are used for simplicity and the magnet gaps in the centred position are defined to be equal between the strong and the stabilising magnets.

\begin{figure}
  \asyinclude{PhD/Figures/Systems/magrotate-schem.asy}
  \caption{Geometry used for analysing the magnetic spring with stable rotation.}
  \figlabel{magrotate-schem}
\end{figure}

\begin{table}
  \caption{Geometric parameters for calculating forces and torques for the magnetic spring shown in \figref{magrotate-schem}.}
  \tablabel{magrotate-param}
  \begin{tabular}{cr}
    \toprule
      $w_1$ &  \SI{100}{mm}  \\
      $w_2$ &  \SI{300}{mm}  \\
      $d_1$ &  \SI{100}{mm}  \\
      $g_1$ &  \SI {10}{mm}  \\
      $s_1$ &  \SI {10}{mm}  \\
      $s_2$ &  \SI  {5}{mm}  \\
    \midrule
      $z_{\text{eq}}$ & \SI{-4}{mm} \\
    \bottomrule
  \end{tabular}
\end{table}

The spring is chosen to have an equilibrium position at $z_{\text{eq}}$ below
the height of the fixed magnets due to the weight being supported.
Spring parameters shown in \tabref{magrotate-param} are chosen to illustrate the concept of having a single degree of instability, and the forces and moments calculated with results shown in \figref{demon-stable-rotation}.
In this figure, the stabilities for displacement and rotation in each degree of freedom are illustrated with the associated forces and torques due to each perturbation.
The spring is in equilibrium at some displacement below the fixed outer magnets such that the force from the magnets balances the load force on the spring; forces in the vertical $z$ direction are given in relative difference terms to this equilibrium force.
In \figref{demon-stable-rotation} negative gradient indicates stability, as the force or torque acts in opposition to the displacement or rotation that caused it.
The figure shows that only the translatory $y$ direction is unstable, and thus in theory only a single actuator would be required to control this system in a non-contact levitating state.

\begin{figure}
  \psfragfig{\phdpath magrotate/fig/stablerot-xyzall}
  \caption{
    Demonstration of single-degree-of-freedom instability.
    The gradients of all forces and torques are negative (infering stability)
    except for the force along the $y$ direction.
  }
  \figlabel{demon-stable-rotation}
\end{figure}

The stability is created by the lever arm of the smaller outer magnets.
The influence of this lever arm on the rotational stiffness of the spring is shown in \figref{stablerot-length}, where the lever arm varies from twice
to four times the centre distance of the strong magnets.
In this range, the rotation stiffness begins negative (as it is without any stabilising magnets) and as the lever arm is increased the stability is increased until it becomes positive between \num{2.5} and~\num{3} times the lever arm of the centre magnets.

\begin{figure}
  \begin{wide}
    \begin{subfigure}
      \psfragfig{\phdpath magrotate/fig/stablerot-length-ry}
      \caption{Around the $y$ axis. Stability decreases with increased lever arm but does not become unstable in the range shown.}
    \end{subfigure}
    \hfil
    \begin{subfigure}
      \psfragfig{\phdpath magrotate/fig/stablerot-length-rz}
      \caption{Around the $z$ axis. Stability ranges from unstable to stable as the lever arm increases.}
    \end{subfigure}
  \end{wide}
  \caption{
    Moment of the magnet spring as it rotates around the $y$ and $z$ axes with a varying lever arm of the stabilising magnets.
    (The moment around the $x$ axis does not vary with lever arm and remains stable.)
    Plots are labelled in terms of the ratio between lever arm of the outer stabilising magnets and the inner strong magnets.
  }
  \figlabel{stablerot-length}
\end{figure}

There is a trade-off between the size of the stabilising magnets and the effectiveness of the main force-providing magnets.
The large lever arm of the stabilising magnets will also affect the stability of the spring in the rotational direction around the $y$ axis; if the stabilising magnets are too large then an added instability will be created, counteracting the added stability around the $z$ axis.
This is illustrated in \figref{stablerot-sizes-all} with spring parameters shown in \tabref{magrotate-param} but with a stabilising magnet size varying from \numrange{0.4}{0.8} of the size of the main magnet size.

\begin{figure}
  \psfragfig{\phdpath magrotate/fig/stablerot-sizes-all}
  \caption{
    Varying the size of the stabilising magnets for the conceptual single-degree-of-freedom magnet spring.
    The lever arm remains constant, in contrast to \figref{demon-stable-rotation}.
    The larger the stabilising magnets the smaller the forces, and the moments around the $y$ and $z$ directions are decrease and increase respectively.
  }
  \figlabel{stablerot-sizes-all}
\end{figure}

Finally, the depth of the spring also affects the stability of this design.
Again using the illustrative parameters of \tabref{magrotate-param}, but with spring depth $d_1$ varying from \SIrange{100}{400}{mm}, the forces and moments are calculated and shown in \figref{stablerot-depth}.
As the spring depth increases, the lever arms in both $y$ and $z$ directions increase, thus increasing the magnitude of the moments produced by a given rotation.
This result indicates that increasing the spring depth does not affect the stability of the spring.

\begin{figure}
  \begin{wide}
    \begin{subfigure}
      \psfragfig{\phdpath magrotate/fig/stablerot-depth-rx}
      \caption{Around the $x$ axis.}
    \end{subfigure}
    \hfil
    \begin{subfigure}
      \psfragfig{\phdpath magrotate/fig/stablerot-depth-rz}
      \caption{Around the $z$ axis.}
    \end{subfigure}
  \end{wide}
  \caption{
    Moment of the magnet spring as it rotates around the $x$ and $z$ axes with a varying spring depth $d_1$, labelled in metres.
    In both cases, the stability increases with greater spring depths.
    (The moment around the $y$ axis does not vary with spring depth and remains stable.)
  }
  \figlabel{stablerot-depth}
\end{figure}

But stability in all but one degrees of freedom is not particularly useful in this configuration because the load-bearing ability of the spring is fairly low; there are no magnets that contribute direction towards creating positive vertical forces.
An alternative magnet design is proposed for this purpose with the goal of retaining the single degree of instability.
An illustrative example of the force and torque characteristics is shown in \figref{demon-stable12}.
While the stiffness along the $y$ direction in this case is very low (and hence close to becoming unstable when the spring is perturbed), this example shows that a design is possible that achieves both sufficient load bearing and minimal instability.

\begin{figure}
  \psfragfig{\phdpath magrotate/fig/stable12-xyzall}
  \caption{
    Demonstration of single-degree-of-freedom instability with greater load bearing.
    The gradients of all forces and torques are negative (infering stability)
    except for the force along the $x$ direction.
  }
  \figlabel{demon-stable12}
\end{figure}


\section{Force coupling between degrees of freedom}
\seclabel{coupling}

A magnetic suspension has inherent dynamic coupling between its degree of
freedom because the magnetic force is a function of displacement in both
horizontal and vertical displacements.

This is essential to consider for the purpose of vibration isolation because
disturbances from the ground can be transmitted via all six degrees of
freedom. Lateral vibrations will cause vertical vibrations; due to symmetry of
the forces in the horizontal directions, vertical disturbances do not couple
to horizontal forces.

An example of this coupling is shown in \figref{coupling-oscillations} for a
suspended magnet that is stabilised in the horizontal direction with the
addition of active positive stiffness. \fxfatal{describe more.}

\begin{figure}
  \psfragfig{\phdpath Simulations/Coupling/fig/coupling-oscillations}
  \caption{Oscillations over time of the displacement of a suspended magnet that is excited through horizontal vibrations of the base magnet. The horizontal vibration couples to the vertical forces.}
  \figlabel{coupling-oscillations}
\end{figure}

In the equilibrium position, the vertical forces are strongest and the
horizontal forces are weakest. The vertical force varies little with
horizontal displacement, as shown in \figref{mag-coupling-equil}, implying
that the coupling between horizontal displacement and vertical force will be
small.

\begin{figure}
  \psfragfig{\phdpath Simulations/Coupling/fig/mag-coupling-equil}
  \caption{Equilibrium position of a suspended magnet bearing a range of
  masses varying with horizontal displacement.
  The displacement is one quarter of the magnet width.}
  \figlabel{mag-coupling-equil}
\end{figure}

The coupling can be quantified by looking at the ratio between horizontal
disturbance displacement range and vertical reaction displacement range. The
larger the horizontal displacement range, the larger the coupling ratio as
shown in \figref{mag-couplingratio-equil}.

\begin{figure}
  \psfragfig{\phdpath Simulations/Coupling/fig/mag-couplingratio-equil}
  \caption{Ratio of vertical to horizontal displacement (`coupling ratio') of
  a suspended magnet bearing a range of masses varying with horizontal
  displacement. The displacement is one quarter of the magnet width.}
  \figlabel{mag-couplingratio-equil}
\end{figure}

\section{Oblique magnetic spring design}

In comparison to using springs with a linear force--displacement relationship for vibration isolation, using permanent magnets for load bearing can be advantageous due to the smaller variation in resonance frequency seen with increased load as a result of a corresponding increased stiffness. However, two permanent magnets in direct repulsion will not completely eliminate the variability in resonance frequency due to load, only reduce it.

A resonance frequency that varies little with load force is desirable due to predicability of the vibratory behaviour; often, vibration isolation systems are tuned to a narrow-band frequency range and are only effective for a given mass. If a nonlinear spring could be designed such that changing applied load $F=mg$ caused the stiffness $k$ to adjust to keep the resonance frequency $\omega_n=\sqrt{k/m}$ constant, a passive tuned vibration neutraliser could be used to isolate the system from unwanted vibrations even under varying loading conditions.

A similar idea using permanent magnets has been mentioned previously by \textcite{todaka2001-ietm}, who suggested using a mechanical linkage with two vertically-oriented magnets such that the floating magnet moved in an arc around a fixed magnet due to the effects of the linkage. However, the parameters governing this design were not investigated; their paper primarily investigated the relationship between resonance frequency and horizontal/vertical displacement between two permanent magnets.

\citeauthor{bonisoli2007-mrc} used the different approach of coupling a magnetic spring with a linear elastic spring, for which a nonlinear analysis and experimental results were shown \parencite{bonisoli2007-mssp, bonisoli2007-mrc}. Such coupled elastic--magnetic systems have been investigated by several authors to various degrees \parencite{trimboli1994, beccaria1997,carrella2008-jsv,zhou2010-jsv}, especially in the design of load bearing systems with high static stiffness and low dynamic stiffness, also known as `quasi--zero stiffness' devices after their design principle of operating near a point of instability in the force/displacement curve where the dynamic stiffness approaches zero.

In related work, we have presented material that uses two magnetic springs, one in attraction and the other in repulsion, to achieve such quasi--zero stiffness effects \parencite{robertson2009-jsv}. In the present work, we exploit the use of magnetic forces in an alternative way that yields a larger region of low stiffness and, if desired, a more stable system. As with all magnetic springs, positive stiffness in the vertical direction infers negative stiffness or instability in at least one horizontal direction \parencite{bassani2006-meccanica}. This instability may be countered with a linear bearing (or some other physical constraint) or with an active control system.

\subsection{Oblique spring geometry and theory}

A schematic of the oblique magnetic spring is shown in \Figref{mbq-schematic}. Cuboid magnets are used that extend a distance $b$ into the page such that their facing sides are squre. The magnet angle $\mbqmagangle$ can range from \SIrange{0}{90}{\degree}, where $\mbqmagangle=\SI{0}{\degree}$ has horizontally-oriented magnets and $\mbqmagangle=\SI{90}{\degree}$ has vertically-oriented magnets.
The spring is composed of two pairs of oblique springs; this ensures the horizontal forces cancel when the spring is centred and force is produced in the vertical direction only.

Note that opposing magnets have parallel sides and anti-parallel magnetisations; hence, the force calculations by \textcite{akoun1984} may be applied to this system. We assume that there are no magnetic interactions between magnets from one side of the spring to magnets on the other side.

With displacement $\mbqvdisp=0$, the facing magnets are horizontally aligned, and with also magnet offset $\mbqoffset=0$, the magnet faces are touching. The force and stiffness characteristics of the spring can be affected by adjusting the magnet angle $\mbqmagangle$ and the magnet offset $\mbqoffset$.

\begin{figure}
\centering
\asyinclude[width=0.8\linewidth]{PhD/Figures/Systems/oblique.asy}
\caption{Schematic of the oblique-magnet spring. When magnet offset $\mbqoffset=0$ and displacement $\mbqvdisp=0$, the magnet faces are aligned and touching.}
\figlabel{mbq-schematic}
\end{figure}

The total force of the spring is given by the sum of the forces for each magnet pair: $\mbqforce=\mbqforce_1+\mbqforce_2$. To calculate $\mbqforce_{1,2}$, we define a local coordinate system for each magnet pair aligned in each direction of magnetisation. Then $\mbqforce_1=\mbqrot{-\theta} \mbqmforce_1$ and $\mbqforce_2=\mbqrot{-\phi}\mbqmforce_2$, where $\phi=\pi-\theta$, $\mbqrot$ is the planar rotation matrix, and $\mbqmforce_{1,2}$ are the forces between the magnet pairs in the local coordinate systems of the base magnets.

These forces $\mbqmforce_{1,2}$ are calculated with $\mbqmforce_{1,2}=F_m(\mbqmdispl_{1,2})$ where $F_m(\cdot)$ is the equation for the force between magnets given by \citeauthor{akoun1984} and $\mbqmdispl_{1,2}$ is the displacement vector between the magnet centres in the local coordinate system of the magnets; $\mbqmdispl_1=\mbqrot{\theta}[d,x]\T+[a,0]\T$ and $\mbqmdispl_2=\mbqrot{\phi}[-d,x]\T+[a,0]\T$. These expressions allow us to calculate $\mbqforce$ in terms of $\mbqvdisp$.

\subsection{Influence of design parameters}

\subsubsection{Magnet shape}

For the analysis continuing, we use a magnet size ratio of $\mbqmagratio=\mbqmagh/\mbqmagw=0.4$. Depending on the exact displacement range to optimise for, values around this magnet ratio produce the maximum force between two opposing cuboid magnets for a fixed magnet volume \parencite{robertson2010-maglett-fix}. For the analysis to follow directly, the magnet volume is fixed at $\mbqvolume=\mbqmagh\mbqmagw^2=(\SI{10}{mm})^3$. We define a `unit length' $u=\sqrt[3]{V}=\SI{10}{mm}$ and refer in the subsequent analysis to the `magnet gap ratio' defined as $d/u$.

\subsubsection{Magnet angle}

Having chosen the magnet size ratio, there are two parameters that influence the force and stiffness characteristics of the spring; these are the magnet angle $\mbqmagangle$ and the magnet offset $\mbqoffset$. Variations in the magnet angle affect the force characteristics to a greater extent and will be examined first.

The theory outlined above was used to calculate force versus displacement curves over a range of magnet angles from \SIrange{0}{90}{\degree}. These are shown in \Figref{mbq-fvx-angle} with associated stiffnesses shown in \Figref{mbq-kvx-angle}. These two graphs show a dramatic affect on the force and stiffness characteristics based on the inclination angle of the magnets. Of particular interest are the low-stiffness regions in the force curves that have a local maxima in \Figref{mbq-fvx-angle}; these are potential areas for improved vibration isolation.

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-fvx-angle}
\caption{Force versus displacement for magnet angles from \SIrange{0}{90}{\degree} in \SI{5}{\degree} increments. The offset distance between the magnets is zero. Light gray lines indicate negative stiffness (instability) and markers show the position of zero stiffness.}
\figlabel{mbq-fvx-angle}
\end{figure}

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-kvx-angle}
\caption{Stiffness versus displacement for magnet angles from \SIrange{0}{90}{\degree} in \SI{5}{\degree} increments. The offset distance between the magnets is zero. Light gray lines indicate negative stiffness (instability) and markers show the position of zero stiffness.}
\figlabel{mbq-kvx-angle}
\end{figure}

\Figref{mbq-fvx-angle} is difficult to use for design purposes, because the required load force will affect the dynamic stiffness as the system sits in equilibrium at a given displacement. However, the rest displacement is not a parameter of particular interest as long as the magnetic spring is still levitating.

The vertical stiffness $\mbqvstiff$ can be obtained with numerical differentiation of the vertical force $\mbqvforce$:
\[
  \mbqvstiff(\mbqvdisp) = - [F_x(x+\delta,0)-F_x(x-\delta,0)]/(2\delta) .
\]
The natural frequency $\omega_n(\mbqvdisp)$ as a function of displacement was calculated in terms of this vertical stiffness $\mbqvstiff$ with
\[
  \omega_n(\mbqvdisp) = \sqrt{\frac{\mbqvstiff(\mbqvdisp)}{\mbqmasseq}} = \sqrt{\frac{\mbqvstiff(\mbqvdisp)}{\mbqvforce(\mbqvdisp)/g}}
\]
where the equivalent mass $\mbqmasseq=\mbqvforce(\mbqvdisp)/g$ is the mass required to load the spring such that its equilibrium position lies at the displacement $\mbqvdisp$. The force corresponding to this equivalent mass is referred to as the `load force'.

By plotting natural frequency as a function of load force in \Figref{mbq-wvf-angle}, we can choose a magnet angle based on a certain load to satisfy a desired natural frequency. Specifically, it can be seen from this graph that at a magnet angle of \SI{35}{\degree}, the natural frequency is almost independent of force for a large range of applied load (approximately $\SI{30}{N}\pm\SI{10}{N}$).

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-wvf-angle}
\caption{Natural frequency versus load force for magnet angles from \SIrange{0}{90}{\degree} in \SI{5}{\degree} increments and zero offset between the magnets. At \SI{35}{\degree}, the natural frequency is constant for a wide range of load forces.}
\figlabel{mbq-wvf-angle}
\end{figure}

\subsubsection{Magnet offset}

\Figref{mbq-wvf-angle} shows the natural frequency versus load curve for a magnet gap ratio of zero. Increasing the magnet gap changes the force and stiffness relationships of the spring; \Figref{mbq-wvf-angle-2} shows the same plot with a magnet gap ratio of \num{0.25}. The difference in the shape of the curves is not great, but this plot shows that a greater magnet gap results in smaller load forces and a smaller range in load force. Also, the angle which corresponds to the almost-flat natural frequency curve has changed to \SI{70}{\degree}.

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-wvf-angle2}
\caption{Natural frequency versus load force for a gap ratio of \num{0.25} and magnet angles from \SIrange{0}{90}{\degree} in \SI{5}{\degree} increments.}
\figlabel{mbq-wvf-angle-2}
\end{figure}

The natural frequency versus load force is redrawn in \Figref{mbq-kvf-gaps} for a fixed magnet angle of \SI{45}{\degree} over a range of magnet gaps from zero to \num{0.5}. At this angle, it can be seen that the region of mostly-flat natural occurs at a gap ratio of \num{0.05}. This indicates that the magnet angle should be chosen only after the tolerances of magnet displacement are decided and a minimum gap ratio established.

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-wvf-gaps}
\caption{Natural frequency versus load force for gap ratios from zero to \num{0.5} in increments of \num{0.05} and a magnet angle of \SI{45}{\degree}.}
\figlabel{mbq-kvf-gaps}
\end{figure}

\subsubsection{Horizontal stability}

In \Figref{mbq-wvf-angle,mbq-kvf-gaps}, design curves were presented under the assumption that the vertical stiffness only was under consideration. Due to the inclination of the magnets, however, the horizontal stiffness will also vary as the magnet spring parameters are changed. If active control is used to constrain the floating magnets, it may be desirable to minimise the horizontal instability of the magnet spring in order to reduce the number of sensors and actuators required to stabilise the system.

The horizontal stiffness is calculated with a numerical gradient between forces when the magnets are centred and when a small horizontal displacement $\mbqhdisp$ is applied. In this case, the displacement vectors between the magnets are $\mbqmdispl_1=\mbqrot{\theta}[\mbqoffset+\mbqhdisp,\mbqvdisp]\T+[\mbqmagh,0]\T$ and $\mbqmdispl_2=\mbqrot{\phi}[-\mbqoffset-\mbqhdisp,\mbqvdisp]\T+[\mbqmagh,0]\T$ and the horizontal stiffness $\mbqhstiff$ as a function of vertical displacement $\mbqvdisp$ is calculated as
\[
\mbqhstiff(\mbqvdisp) = -[\mbqhforce(\mbqvdisp,\delta)-\mbqhforce(\mbqvdisp,0)]/\delta,
\]
where $\delta$ is a small displacement increment.

An example of spring parameters that achieve positive stability in both the vertical and horizontal directions is shown in \Figref{mbq-kvxy-gaps}. This is possible as the stiffness in the out-of-the-page direction of \Figref{mbq-schematic} is always negative.

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-kvxy-gaps}
\caption{Vertical and horizontal stiffness versus displacement for a gap ratio of \num{0.2} and magnet angles from \SIrange{0}{90}{\degree} in \SI{5}{\degree} increments (arrows indicate increasing magnet angle). Regions of positive stiffness for both directions are coloured; regions of gray indicate that either the vertical and/or horizontal stiffness is negative in that position for that magnet angle.}
\figlabel{mbq-kvxy-gaps}
\end{figure}

The drawback of achieving minimal instability is a reduction in the achievable low-stiffness regions of the spring. \Figref{mbq-wvf-angle-stabl} shows a plot of natural frequency versus load force for a magnet angle of \SI{40}{\degree} and for a variety of magnet gaps. In this graph, regions of negative horizontal stiffness have been de-emphasised by drawing those sections of the curves in light grey. It can be seen here that the `flat' sections of the curve (that correspond to configurations of largely-flat natural frequency against load force) occur largely in the regions of horizontal instability.

\Figref{mbq-wvf-angle-stabl} also demonstrates that when designing the system for horizontal stiffness, a larger magnet gap increases the displacement range of the magnetic spring, albeit with a decrease in possible load force.

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-wvf-angle-stabl}
\caption{Natural frequency versus load force for gap ratios from \num{0.05} to \num{0.5} in \num{0.05} increments and a magnet angle of \SI{40}{\degree}. Regions of negative horizontal stiffness are drawn in light gray, and displacements are labelled with dotted lines for every change in displacement of \SI{1}{mm}.}
\figlabel{mbq-wvf-angle-stabl}
\end{figure}

\subsubsection{Magnet volume}

Having examined the influence of magnet angle and magnet gap on the natural frequency and load force characteristics, it is essential to confirm that this arrangement is scalable for arbitrary loads by scaling up the magnet volumes. With fixed magnet gap ratio of 0.2 and magnet angle of \SI{40}{\degree}, the natural frequency/force characteristic is shown in \Figref{mbq-wvf-vol}. The displacement ranges are proportional to the magnet size such that the system with magnet volume $(\SI{10}{mm})^3$ undergoes displacement from \SIrange{0}{10}{mm} and the system with volume $(\SI{50}{mm})^3$ moves over \SIrange{0}{50}{mm}.

\Figref{mbq-wvf-vol} shows that larger magnet sizes permit larger load forces while also retaining a low natural frequency. In fact, the natural frequency decreases with larger magnet sizes. This shows that the oblique magnet spring system is suitable for bearing large loads with low stiffness, and fits into the category of springs that exhibit `high-static--low-dynamic' stiffness.

\begin{figure}
\centering
\psfragfig{magcode/examples/oblique/fig/mbq-wvf-vol}
\caption{Natural frequency versus load force for a magnet gap ratio of \num{0.2} and a magnet angle of \SI{40}{\degree} over a range of magnet volumes from $(\SI{10}{mm})^3$ to $(\SI{50}{mm})^3$. Regions of negative horizontal stiffness are drawn in light gray.}
\figlabel{mbq-wvf-vol}
\end{figure}




\section{Forces due to an electromagnetic field}
\seclabel{emforces}

This section describes a theoretical, parametric study that was undertaken to
describe the forces between a cylindrical magnet and cylindrical
current-carrying coil. While approximate formulations are known in the general
literature (\fxfatal{reference}), the approach taken here was a complete
analytical study using the exact geometry of both coil and magnet. The
forces were numerically evaluated from a series of symbolic integrals in
Mathematica.

The purpose of these calculations was to design a coil to drive a non-contact
vibrating platform; a non-contact coil, rather than a classical shaker, say,
was chosen for its zero stiffness properties; without driving current, the
coil does not add stiffness to the structure (although it does add damping via
velocity-induced eddy currents). Additionally, the actuator does not add mass
to the vibratory system. \fxfatal{discuss `zero impendance' instead of
zero stiffness; added `mass' via induced eddy currents, etc.}

The study also investigates the possibility of building large, low-cost
inertial shakers by using an arrangement of smaller magnets instead of one
large, expensive permanent magnet. (\fxfatal{reference Chris Fuller's work with
George.}) However, this study does \emph{not} investigate the dynamics
associated with driving the coil with an alternating current; only the static
force due to a constant current is investigated.

\fxfatal{Figure for dual coil system}

Finally, a symmetric arrangement of two coils in series driving a central
magnet is examined. Since a coil/magnet pair must be located asymmetrically to
generate maximum force, generally electromagnets of this type are built with
`push-pull' coils, where a second coil is added to restore symmetry to the
force \vs\  displacement response of the actuator.

The study is split into three parts, as described above:
\begin{enumerate}
\item Force on a magnet due to a single coil;
\item Force from a single coil on a multitude of smaller magnets; and,
\item Force on a magnet due to symmetric dual-coils.
\end{enumerate}

\subsection{Derivation of the force equations}

In this section, the equations of the force between a single cylindrical coil and a
cylindrical magnet
are established; this forms the mathematical basis for the three parts of the
study. The theory in this section is based on the theory given by
\textcite{furlani2001}. Conceptually, deriving the force between a coil and
magnet can be summarised in two steps:
\begin{itemize}
\item Integrate a function of the current over the volume of the coil
  to find the magnetic field produced at a specific point in space.
\item Integrate a function of the magnetic field over the volume of a
  magnet to find the force produced by the interaction of the magnetic
  field of the coil and the magnet itself.
\end{itemize}

A schematic of the general system is shown in two dimensions in
\figref{int-geometry}, in which the \compound{co}{ordinate} systems Cartesian
$(\coordca{1},\coordca{2},\coordca{3})$ and cylindrical
$(\coordra{1},\coordra{2},\coordra{3})$ are defined for the geometry of the
coil; and the \compound{co}{ordinate} systems Cartesian
$(\coordcb{1},\coordcb{2},\coordcb{3})$ and cylindrical
$(\coordrb{1},\coordrb{2},\coordrb{3})$ are defined for the geometry of the
magnet. Axial \compound{co}{ordinates} $\coordca{3}$ and $\coordcb{3}$ are oriented in
the `out-of-page' direction.

\begin{figure}
\small
\asyfig{Coil/integral}
\caption{
  Cross section schematic of the system with coil cross section
  $\surfCoil$ and magnet cross section $\surfMag$.
}
\figlabel{int-geometry}
\end{figure}

Start by looking at the magnetic field produced by the electromagnet. Define
in cylindrical \compound{co}{ordinates} $\distra=\distra{1,2,3}$ as the displacement
vector for the point in space at which the magnetic field is being calculated
(inside the volume of the magnet), and $\distrb=\distrb{1,2,3}$ as the
displacement vector to a differential volume of the coil. The magnetic
field $\magB$ from a current source $\magJ$ is given by:
\cite[][\S3.3]{furlani2001}
\begin{dmath}
\magB\fn{\distra} = \magconst\Int{\frac{\magJ\fn{\distrb}\cross\gp{\distra -
\distrb}}{\Abs{\distra-\distrb}^3}}{\diffvolCoil,\volCoil}
\end{dmath},
where $\permVac$ is the permeability of free space and $\cross$ is the vector
cross product.

In \figref{int-geometry} the volumes $\dee\diffvolCoil$ and $\volCoil$ are
shown as cross-sectional surfaces $\dee\diffsurfCoil$ and $\surfCoil$. In
cylindrical \compound{co}{ordinates},
$\dee\diffvolCoil=\distrb{1}\dee{\distrb{1}}\dee{\distrb{2}}\dee{\distrb{3}}$,
and
\begin{dmath}
\Abs{\distra-\distrb} = \sqrt{\distra{1}^2+\distrb{1}^2-2\distra{1}\distrb{1}\Cos{\distra{2}-\distrb{2}}+\gp{\distra{3}-\distrb{3}}^2},
\end{dmath}
which results in the intermediate expression
\begin{dmath}
\magB(\distra{1},\distra{2},\distra{3}) =
\magconst
  \Int{%
    \gp{\magJ(\distrb{1},\distrb{2},\distrb{3})\cross
          \gp{\distra-\distrb}}
         \gp{\distra{1}^2+\distrb{1}^2-2\distra{1}\distrb{1}\Cos{\distra{2}
          -\distrb{2}}+\gp{\distra{3}-\distrb{3}}^2}^{-3/2}\distrb{1}}
  {\distrb{1},\offsetCoilMag-\lengthCoil/2,\offsetCoilMag+\lengthCoil/2}
  {\distrb{2},0,2\pi}
  {\distrb{3},\iradiusCoil,\oradiusCoil}
\end{dmath}
for inner and outer radii of the coil $\iradiusCoil$ and $\oradiusCoil$
respectively, axial coil length $\lengthCoil$, and axial distance between the
magnet and coil centres $\offsetCoilMag$.

The current density of the coil is
$\magJ(\distrb{1},\distrb{2},\distrb{3})=NI/A\coordra{2}$, where $N$ is the
number of turns of wire, $I$ is the current flowing in the coil, and
$A=\lengthCoil\gp{\iradiusCoil-\oradiusCoil}$ is the cross sectional
area of the electromagnet. Therefore,
\begin{dmath}
\magJ\fn{\distrb{1},\distrb{2},\distrb{3}}\cross\gp{\distra-\distrb} =
  NI/A\cdot\inlinevect{\distra{3}-\distrb{3},0,\distra{1}-\distrb{1}}
\end{dmath},
resulting in the final magnetic field equation
\begin{dmath}[label=coil-B]
\magB(\distra{1},\distra{2},\distra{3}) =
\magconst\cdot\frac{NI}{A}
  \Int{
    \distrb{1}
    \inlinevect{\distra{3}-\distrb{3},0,\distra{1}-\distrb{1}}
    \gp{\distra{1}^2+\distrb{1}^2-2\distra{1}\distrb{1}\Cos{\distra{2}-
        \distrb{2}}+\gp{\distra{3}-\distrb{3}}^2}^{-3/2}
  }
  {\distrb{1},\offsetCoilMag-\lengthCoil/2,\offsetCoilMag+\lengthCoil/2}
  {\distrb{2},0,2\pi}
  {\distrb{3},\iradiusCoil,\oradiusCoil}
\end{dmath}
or more applicably here (since it is the axial force that is of interest),
\begin{dmath}
\magB{z}(\distra{1},\distra{2},\distra{3}) =
\magconst\cdot\frac{NI}{A}
\Int{
  \distrb{1}\gp{\distra{1}-\distrb{1}}
  \cdot
  \gp{\distra{1}^2+\distrb{1}^2
      -2\distra{1}\distrb{1}\Cos{\distra{2}-\distrb{2}}
      +\gp{\distra{3}-\distrb{3}}^2
     }^{-3/2}
  }
  {\distrb{1},\iradiusCoil,\oradiusCoil}
  {\distrb{2},0,2\pi}
  {\distrb{3},\offsetCoilMag-\lengthCoil/2,\offsetCoilMag+\lengthCoil/2}
\eqlabel{coil-Bz}
\end{dmath}

To obtain force, the magnetic field from the electromagnet is
integrated over the region of the permanent magnet. This is the
summation of a volume and surface integral:
\begin{dmath}
\force = \Int{\gp{\Div{\magM}}\magB}{\diffvolMag,\volMag}+\oint_{\surfMag}
\gp{\magM\dotprod\normn}\magB\,\dee{\diffsurfMag}
\end{dmath}
The magnet is magnetised along its axis, and the magnetisation is
assumed to be constant (a reasonable assumption for rare earth
magnets \fxfatal{cite}). The magnetisation is $\magM=M\hat{\vect{z}}$, which implies
$\Div{\magM}=0$. Therefore,
\begin{dmath}
\force = \oint_S \gp{\magM\dotprod\normn}\cdot\magB(\distra{1},\distra{2},\distra{3})\,\dee{s} ,
\end{dmath}
where $\normn$ is the normal vector of the magnet surface $\surfMag$. For a
cylindrical magnet,
\begin{dmath}
\normn = \left\{
  \begin{array}{@{}c@{\quad}l}
    \pm\hat{\vect{z}} &
        \distra{3} = \pm \half\lengthMag,
        \quad \distra{1}\leq \oradiusMag \\
    \hat{\vect{r}} &
        -\half\lengthMag < \distra{3} < \half\lengthMag,
        \quad \distra{1}=\oradiusMag
  \end{array}\right.
\end{dmath}
for axial magnet length $\lengthMag$. Since $\magM$ is orthogonal to
$\hat{\vect{r}}$ their dot product is zero, and
\begin{dseries}
\begin{math}
  \magM\dotprod\normn = \pm M
\end{math},
\begin{math}
  \distra{3}=\pm \half\lengthMag
\end{math}
\end{dseries}
which leads to the final expression
\begin{dmath}
\eqlabel{Fds}
\force =
  \left.\Int {M\magB(\distra{1},\distra{2},\distra{3})}{\diffsurfMag,\surfMag}\right|_{\distra{3}=\lengthMag/2}
 +\left.\Int{-M\magB(\distra{1},\distra{2},\distra{3})}{\diffsurfMag,\surfMag}\right|_{\distra{3}=-\lengthMag/2}
=
  \Int{M\magB(\distra{1},\distra{2},\lengthMag/2) \distra{1}}
      {\distra{1},\iradiusMag,\oradiusMag}
      {\distra{2},0,2\pi}
 -\Int{M\magB(\distra{1},\distra{2},-\lengthMag/2) \distra{1}}
      {\distra{1},\iradiusMag,\oradiusMag}
      {\distra{2},0,2\pi}
\end{dmath},
and more applicably,
\begin{dmath}[label=coilFzindirect]
F_z =
  \Int{M\magB{z}(\distra{1},\distra{2},\lengthMag/2) \distra{1}}
      {\distra{1},\iradiusMag,\oradiusMag}
      {\distra{2},0,2\pi}
 -\Int{M\magB{z}(\distra{1},\distra{2},-\lengthMag/2) \distra{1}}
      {\distra{1},\iradiusMag,\oradiusMag}
      {\distra{2},0,2\pi} ,
\end{dmath}

Substitution of \eqref{coil-B} into \eqref{coilFz} yields a quintuple integral,
which can be evaluated to obtain the force on the magnet due to the current carrying coil.
A complete analytical solution for this integral is not known to be analytically tractable at this time;
the usual approach is to symbolically integrate as many terms as possible and then
numerically integrate the rest. Here, the angles $\distra{2}$ and $\distrb{2}$
are symbolically integrated in \eqref{coilFzindirect} to produce the final
equation
\begin{dmath}[label=coilFz]
  F_z = B_r \tfrac{N I}{A} \Int{
      \sum_{e_1,e_2\in\{1,-1\}^2}
      e_1 e_2 f_z\fn{e_1\lengthMag/2,\offsetCoilMag+e_2\lengthCoil/2}
    }
    {\distra{1},\iradiusMag,\oradiusMag}
    {\distrb{1},\iradiusCoil,\oradiusCoil}
\end{dmath}
where the intermediate term $f_z$ is
\def\l#1{l_{#1}}
\begin{dmath}
  f_z\fn{\l1,\l2} =
   \frac
    {
     2 \distra{1} \distrb{1}
     \gp{ \l1 - \l2 }
    }
    {
     \gp{\distra{1}-\distrb{1}}
     \sqrt{
          \gp{\distra{1}-\distrb{1}}^2
         +\gp{\l1-\l2}^2
     }
    }\times\\
    \Pi\fn{
      -\frac
        { 4 \distra{1} \distrb{1} }
        { \gp{\distra{1}-\distrb{1}}^2 }
      \middle|
      -\frac
        { 4 \distra{1} \distrb{1} }
        {
          \gp{\distra{1}-\distrb{1}}^2
         +\gp{\l1-\l2}^2
        }
     }
\end{dmath}.
The function $\Pi\fn{n|m}$ is the complete elliptic integral of the third kind.

Varying centre displacement $\offsetCoilMag$ produces force versus displacement results for a given magnet/coil geometry.
Varying $\lengthCoil$, $\lengthMag$ and the other parameters in the integration limits, $\iradiusMag$ ($=0$ for cylindrical magnets), $\oradiusMag$, $\iradiusCoil$, $\oradiusCoil$, allows comparisons to be made between differently sized magnets and coils.

\subsubsection{Including axial offset}

It is also desirable to calculate forces for asymmetric magnet positions, for
reasons of either evaluating the effects of unbalanced load, or for building
more complex geometries. It is the latter application that will be
investigated here, with an analysis of the forces produced with a ring of a
number of smaller magnets compared to that of using a solid ring magnet.

The integrals used in \eqref{Fds} to calculate the forces have variables of
integration $\dee\diffsurfMag=\distra{1}\dee{\distra{1}}\dee{\distra{2}}$ and
integrands containing the the magnetic field $\magB$ in terms of those
variables $\distra{1}$ and $\distra{2}$. However, when the magnet is no longer
centred inside the coil, the integration must take place in the shifted
coördinate system shown in \figref{int-offset}.

\begin{figure}
\asyfig{Coil/circle-offset}
\caption{Region of integration for axially displaced magnet
  surfaces. The magnet is shifted by $(\xi,\eta)$ from the original
  coördinate system.}
\figlabel{int-offset}
\end{figure}

In order to perform this integration, terms in $\magB$ of $\distra{1}$
and $\distra{2}$ must be expressed instead in terms of $\distra{1}'$
and $\distra{2}'$. That is, to use a slightly general example, we wish
to analyse the integral of generic function $A$:
\begin{dmath}
\Int{A(\distra{1},\distra{2})}{a} =
\Int{A(\distra{1},\distra{2})\,\distrb{1}}%
    {\distrb{1},\iradiusMag=0,\oradiusMag}%
    {\distrb{2},0,2\pi} .
\end{dmath}
The following transformation can be used to perform this:
\begin{align}
\distra{1} &= \sqrt{\distca{1}^2+\distca{2}^2} &
\distca{1} &= \distca{1}' - \xi                 &
\distca{1}' &= \distra{1}'\Cos{\distra{2}'}
\\
\distra{2} &= \ArcTan{\distca{2},\distca{1}}  &
\distca{2} &= \distca{2}' - \eta               &
\distca{2}' &= \distra{1}'\Sin{\distra{2}'}
\end{align}
Accordingly, the force integral for the magnet--coil system with radial eccentricity as well as axial displacement is given by
\begin{dmath}[label=coileccfz]
  \frac{NI\remanence}{4A\pi}
  \Int{
    \sum_{e_1,e_2\in\{1,-1\}^2}
      e_1 e_2 f_z\fn{e_1\lengthMag/2,\offsetCoilMag+e_2\lengthCoil/2}
    }
    {\distra{1}',\iradiusMag,\oradiusMag}
    {\distra{2}',0,2\pi}
    {\distrb{1},\iradiusCoil,\oradiusCoil}
\end{dmath},
where the intermediate function $f_z$ is
\begin{dmath}
  f_z\fn{l,z} =
  f_2\fn{l,z}
  \frac{
    2 \distra{1}' \distrb{1} \gp{ l-z }
    \sqrt{
      1-\frac{2 \distra{1} \distrb{1} \gp{\cos\fn{\phi_1}-1}}
             {\gp{l-z}^2+\gp{\distrb{1}-\distra{1}}^2}
    }
  }
  {
   \gp{\distrb{1}-\distra{1}}^2
   \sqrt{
         \distra{1}^2+\distrb{1}^2
         - 2 \cos\fn{\phi_1} \distra{1} \distrb{1}
         + \gp{l-z}^2
        }
  }
\end{dmath},
and the second intermediate function $f_2$ is given by
\begin{dmath}
  f_2\fn{l,z} =
     \Pi\fn{
       \frac{ - 4 \distra{1} \distrb{1}}
             {\gp{\distrb{1}-\distra{1}}^2}
       ;
       \frac{\phi_1}{2}
       \middle|
       \frac{ - 4 \distra{1} \distrb{1}}
             {\gp{l-z}^2+\gp{\distrb{1}-\distra{1}}^2}
     }
     -
     \Pi\fn{
       \frac{ - 4 \distra{1} \distrb{1}}
             {\gp{\distrb{1}-\distra{1}}^2}
       ;
       \frac{\phi_1}{2}-\pi
       \middle|
       \frac{ - 4 \distra{1} \distrb{1}}
             {\gp{l-z}^2+\gp{\distrb{1}-\distra{1}}^2}
     }
\end{dmath}.
In \eqref{coileccfz}, two symbolic integrations have been performed (first over $\distrb{2}$ and subsequently over $\distrb{2}$) and the remaining three
integration variables must be evaluated numerically.


\subsubsection{Integration accuracy}

The precision of the numerical integration needs to be selected for an
appropriate compromise between accuracy and computation time. Varying
Mathematica's \verb|PrecisionGoal| from 1--4 (which is equivalent to the
number of `correct' significant figures), a typical force curve \vs\
displacement calculation ranges in processing time as shown in
\tabref{numerical-integration-times}. Eleven integrations were performed over
a range of displacements from zero to \SI{20}{mm} in steps of \SI{2}{mm}. The
physical parameters used are shown in \tabref{prec-param}.

\begin{table}
\caption{Processing time of numerical integration for increasing
precision (in significant figures accurate) of the results.}
\tablabel{numerical-integration-times}
\begin{tabular}{lcccc}
\toprule
Precision & \num{1}    & \num{2}   & \num{3}  & \num{4}   \\
Time (s)  & \num{0.25} & \num{1.6} & \num{18} & \num{187} \\
\bottomrule
\end{tabular}
\end{table}

\begin{table}
\caption{Parameters used in the model for evaluating the numerical precision of integration.}
\tablabel{prec-param}
\begin{tabular}{@{}llcc@{}}
\toprule
\multicolumn{2}{@{}l}
  {Parameter}       & Symbol       & Value         \\
\midrule
Magnet & Remanence  & $\remanence  $ & \SI{1.2}{T}   \\
       & Radius     & $\oradiusMag $ & \SI{6.35}{mm} \\
       & Length     & $\lengthMag  $ & \SI{6.35}{mm} \\
\midrule
Coil & turns        & $\turnsWire  $ & \num{400}     \\
     & Current      & $\current    $ & \SI{1}{A}     \\
     & Inner radius & $\iradiusCoil$ & \SI{7}{mm}    \\
     & Outer radius & $\oradiusCoil$ & \SI{15}{mm}   \\
     & Length       & $\lengthCoil $ & \SI{7.5}{mm}  \\
\bottomrule
\end{tabular}
\end{table}

The forces calculated with precisions of one, two, and three significant
figures are shown in
\figref{voice-coil-integration-precision} accompanied by the error of the
curves with respect to the values calculated with a precision of four significant
figures. The
error was calculated with
\begin{dmath*}
    100 \times \Abs{\frac{F_4 - F_i}{F_4}}
\end{dmath*}
where $F_i$ is the force calculated with a precision of $i$. Reasonable results are
obtained with a precision of two significant figures (error less than 5\%), and very accurate
results (less than 0.1\% error) are obtained with a precision of three.

\begin{figure}
\begin{wide}
\begin{subfigure}
  \psfragfig{\coilpath voice-coil-integration-precision}
  \caption{Forces with labelled precisions of 1--3.}
\end{subfigure}
\begin{subfigure}
  \psfragfig{\coilpath voice-coil-integration-precision-error}
  \caption{Percentage error with respect to the forces calculated with a precision of four.}
\end{subfigure}
\end{wide}
\caption{Precision of numerical integration for calculating the force \vs\  distance
values on a magnet from an electromagnet.}
\figlabel{voice-coil-integration-precision}
\end{figure}

\subsection{Parameters}

Now that a mathematical model is available to perform the calculations,
thought must be given to the variables used in the forthcoming parametric
study. The parameters must be varied in such a way that comparisons between
cases are meaningful. Changing the coil's physical parameters (length, radii,
wire thickness) affect the current flowing through it for a fixed input
voltage; these parameters are interrelated and cannot be varied independently
while making direct comparisons between the change in the forces due to these
variations. Careful consideration on which parameters to vary directly, and
how, is required.

\paragraph{Electromagnet parameters}

The magnetic field (which is directly responsible for inducing force
on a magnet) produced by a coil varies with a number of parameters:
axial length, inner radius, outer radius, current, number of turns, wire
diameter, and so on. However, these are not all independent.

The starting point for the design of a coil is to choose its
resistance, which is performed by matching the impedance of the
amplifier used to drive the coil. In this case, resistance was taken
as $R=\SI{8}{\ohm}$. This requirement ensures that comparisons can be
made between differently sized coils that consume the same amount of
power.

The resistance of the coil directly infers the length of the wire
winding, $\lengthWire$, through the relation
\begin{dmath}
\lengthWire = \resistanceCoil \areaWire / \resistivity,
\end{dmath}
for wire of cross sectional area $\areaWire$, and resistivity $\resistivity$.
Copper wire with a diameter $\diamWire=\SI{0.2}{mm}$ was selected with an
approximate resistivity $\resistivity=\SI{1.7e-8}{\ohm.m}$.

The fixed parameters of the coil are driving voltage, resistance, wire
thickness and material, which in turn fix the total length of wire. The
results of the parametric study are specific to the values chosen above. Based
on these values, a relationship between the macroscopic parameters of the coil
can be derived.

\begin{figure}
  \asyfig{Coil/turns-cross-section}
  \caption{Schematic representation of a crude wire-wound coil with
    labelled dimensions.}
\figlabel{coil-turns}
\end{figure}

The dimensions of a cylindrical coil are depicted in \figref{coil-turns},
showing three turns of wire in each direction in an
$\coordca{1}$--$\coordca{3}$ cross-section. Given a total length of wire to
use (determined by the total resistance allowed for the coil), it is possible
to derive a relation between the coil length, $\lengthCoil$, and the coil
radii, $\iradiusCoil$ and $\oradiusCoil$ ($\iradiusCoil<\oradiusCoil$).
Assuming that each turn of wire sits directly above or adjacent to its
neighbours, an approximate expression for the total wire length is given by
\begin{dmath}[label=coil-lengthwire]
\lengthWire = \turnsZWire\Sum{2\pi\gp{\iradiusCoil+n\diamWire}}{n,0,N-1}
  = 2\pi \turnsRWire \turnsZWire \gp{\iradiusCoil+\diamWire/2},
\end{dmath}
where $\turnsZWire=\gp{\oradiusCoil-\iradiusCoil}/\diamWire$ and
$\turnsRWire=\lengthCoil/\diamWire$ are the number of turns in the axial and
radial directions. While this does not accurately model the packing effect of
how tightly-packed coils will sit (since ideally \eqref{coil-lengthwire} will
under-represent the number of turns possible in a given cross-sectional area),
this equation is simple and allows some conservatism in the quality of the
construction of the electromagnet.

Therefore, an expression for the outer radius of the coil that is defined for
a coil of fixed inner radius and fixed total wire length is:
\begin{dmath}
  \oradiusCoil = \iradiusCoil +
    \dfrac{\lengthWire\diamWire^2}
          {\pi\lengthCoil\gp{2\iradiusCoil+\diamWire}}.
\end{dmath}

\paragraph{Overall parameters varied}

In the parametric study to follow, a number of independent parameters have
been found to vary (assuming fixed impedance and wire diameter): axial distance
between the magnet and coil centres, $\offsetCoilMag$; axial lengths of the
magnet and coil, $\lengthMag$ and $\lengthCoil$; inner and outer radius of the
magnet, $\iradiusMag$ and $\oradiusMag$; and, inner radius, $\iradiusCoil$, of
the coil.

The remanence of the permanent magnet, $\remanence$, is taken to be \SI{1.2}{T}
for this section; this approximates using a low-strength rare earth permanent
magnet. The magnetisation, $\magM$, then, is given by $\remanence/\permVac$.

Later, when dual coils are used to drive the magnet, the effect of the
adjusting the gap between the two coils on the induced force on the
magnet is examined.

\fxfatal{Tabulate coil simulation parameters/}

\paragraph{On comparisons}

The various graphs presented later are generated with different geometries of
the coil(s) and magnet(s). This makes comparisons between separate results
difficult or inconclusive. This has been done with a mind to try and show
trends in the behaviours of varying various parameters separately; no single
set of results can illustrate the behaviour of the system under such a large
number of parameter variations.

Take the results as shown, then, as indicative of methods that \emph{can} be
used for optimising a certain electromagnetic design. Without a cost function
to optimise, however, such `optimisation' here would be premature. \fxfatal{reword}

\subsection{Single coil/single magnet simulations}

In this section, several results are shown demonstrating the effect on the
force/displacement curves of varying different parameters in a single
magnet--single coil system. Diagrams, which are drawn to relative scale,
accompany each force \vs\  displacement curve to illuminate the systems under
analysis. For axial (side-on) diagrams, the magnet is located at the position
of maximum force.

\paragraph{Equal length magnet and coil}

For coils and magnets of equal lengths,
shown in \figref{voicecoil3-vary-length-2d}, the peak force is
obtained for magnets with an approximately equal diameter and
length. Despite the greater volume of magnetic material, the peak force actually
decreases with increasing magnet lengths.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Coil/single-coil-2d_1_0}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath voicecoil3-vary-length-2d}
  \end{subfigure}
  \lofcaption{Forces between various coil and magnet pairs of equal but
    varying length.}{ The magnet radius is $\oradiusMag=\SI{6.4}{mm}$ and the
    inner coil radius is $\iradiusCoil=\SI{7}{mm}$. Note the change in
    outer coil radius as the coil length varies in order to retain a constant
    resistance.}
  \figlabel{voicecoil3-vary-length-2d}
\end{figure}

While this effect is also governed by the length of the coil (which will be
examined subsequently), \figref{vary-radii} shows that increasing the magnet
\emph{radius} (and the coil radius in tandem) does increase the
total force from the electromagnet.

In both cases, the total magnet volume is varied while the coil power is kept
constant. While it may be intuitive that increasing the size of the magnet
increases the force due to the coil, this is only true in the second case.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Coil/single-coil-2d_2_0}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath voicecoil3-vary-radii-2d}
  \end{subfigure}
  \lofcaption{Forces between various coil and magnet pairs of fixed length
    but varying diameters.}{ The coil and magnet lengths are
    $\lengthCoil=\SI{7}{mm}$ and $\lengthMag=\SI{12.7}{mm}$,
    and the inner radius of the coil is $\iradiusCoil=\oradiusMag+\SI{1}{mm}$.
    The `glitch' at \SI{0.25}{mm} for the $\oradiusMag=\SI{20}{mm}$ case
    is due to numerical imprecision in the computation of the integral.}
  \figlabel{vary-radii}
\end{figure}

\paragraph{Length/radius ratio between the coil and magnet}

The ratio between the lengths of the coil and magnet has several
effects on the force between them. \Figref{vary-mag-length} shows the
effect of increasing the magnet length with a fixed-size coil, for
which the maximum force produced asymptotes to a maximum as the
length of the magnet increases.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Coil/single-coil-2d_3_0}
  \end{subfigure}\par
  \begin{subfigure}
    \small\psfragfig{\coilpath voicecoil3-vary-lengthratio-2d}
  \end{subfigure}
  \lofcaption{
Forces between varius coil and magnet pairs with fixed coil length.}{
The coil length is $\lengthCoil=\SI{20}{mm}$,
the magnet radius is $\oradiusMag=\SI{6.4}{mm}$, and
the coil inner radius is $\iradiusCoil=\SI{7}{mm}$.}
  \figlabel{vary-mag-length}
\end{figure}

Conversely, \figref{vary-coil-length} shows that \emph{decreasing} the
length of the coil increases the force created on a fixed-size
magnet. Recall that as the coil geometry is chosen to ensure a constant
resistance and hence power consumption. This is shown in the schematics of
\figref{vary-coil-length}: as the coil length increases, its height decreases.

It is interesting to compare the positions of maximum force
between the cases shown in \figref{vary-mag-length,vary-coil-length};
which is depicted in the schematics above each graph.
It can be seen that the maximum force is obtained, approximately, when
the shorter of the magnet or coil is axially centred at an edge of the longer.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Coil/single-coil-2d_4_0}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath voicecoil3-vary-lengthratio2-2d}
  \end{subfigure}
  \lofcaption{
Forces between varius coil and magnet pairs with fixed magnet length.}{
The magnet width is $\lengthMag=\SI{20}{mm}$,
the magnet radius is $\oradiusMag=\SI{6.4}{mm}$, and
the coil inner radius is $\iradiusCoil=\SI{7}{mm}$.}
  \figlabel{vary-coil-length}
\end{figure}

Finally, it is worth noting the width of the peaks in the
force/displacement curves for these various systems. The shorter coil
gives greater forces, but at the expense of a smaller `width' of force
close to the maximum. When used as shakers, these coils are assumed to
have a proportional relationship between current and force, which is only valid
around the region of maximum force for a certain displacement range.
Practically, this limits the lower frequency (which has larger displacements)
at which such a device could impart vibrations into a structure.

\paragraph{Air gap}

A study of the effect of the size of the air gap between the coil and the
magnet, with results in \figref{vary-airgap}, shows that the smaller the air
gap, the significantly greater the forces generated. The slight movement of
the position of maximum force is interesting but negligible.

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Coil/single-coil-2d_5_0}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath voicecoil-vary-coilradius-2d}
  \end{subfigure}
  \lofcaption{
    Forces between varius coil and magnet pairs with varying
    coil inner radius.}{ The peak force is indicated by the labelled points.
    The magnet radius is $\oradiusMag=\SI{5}{mm}$, and
    the magnet and coil lengths are $\lengthMag=\lengthCoil=\SI{7.5}{mm}$.
  }
  \figlabel{vary-airgap}
\end{figure}

\paragraph{Eccentricity}

In \secref{manymag}, the superposition of eccentric magnets will be used to
analyse some multi-magnet cases. The effects of eccentricity of the inner
magnet are shown in \figref{vary-eccentric}, where it can be seen that
displacements close to the centre have only a small effect on the force.
Closer to the inner radius of the coil, however, large increases in force
occur as the magnet draws near, which follows from results seen previously in
\figref{vary-airgap}.

\begin{figure}
  \begin{subfigure}
    \asyfig{Coil/eccentric}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath coils-offsetTest}
  \end{subfigure}
  \lofcaption{
    Forces between a coil and a magnet with varying radial eccentricity,
    $\offsetCoilMag$\periodifnocomma}{, shown in \si{mm}.
    The inner radius of the coil is $\iradiusCoil=\SI{21}{mm}$, and
    the radius of the magnet is $\oradiusMag=\SI{10}{mm}$
    Note that while the offset
    is in the radial direction, the force shown is still in the axial
    direction.}
  \figlabel{vary-eccentric}
\end{figure}


\subsection{Approximation of a large magnet by the superposition of others smaller}
\seclabel{manymag}

As has been shown in \figref{vary-radii}, increasing the radii of the
magnet/coil system increases the forces generated between them, but it
can be difficult or expensive to procure such large magnets. A
collection of smaller magnets can be used instead, with improved cost
and handling convenience, albeit with some reduction in the maximum
force achievable.

Referring to \figref{circles}, the radius of a smaller circle, $r$,
that fits \COILnmag\ times around inside the circumference of a larger circle
of radius $R$, with a gap between adjacent circles of $d$ is given by
\begin{dmath}
\eqlabel{circles}
r = \frac{R\Sin{\pi/\COILnmag}-d/2}{\Sin{\pi/\COILnmag}+1}.
\end{dmath}

\begin{figure}
  \begin{subfigure}
    \asyfig{Coil/circles}
  \end{subfigure}
  \lofcaption{Geometry of smaller circles tangential to a larger
    circle.}{ $\theta=2\pi/\COILnmag$ for \COILnmag\ smaller circles in total.}
  \figlabel{circles}
\end{figure}

This expression can be used to calculate the radius of \COILnmag\ smaller
magnets that can be used to fill up the volume of a larger one. In the
first case, the larger magnet is approximated with a concentric
arrangement of disc magnets, approximating ring magnetisation.
Such a configuration can be modelled with the same expressions derived
for the simple cases in the previous section. Superposition can be
used to extrapolate the force from a single small eccentric magnet to
a ring of them.

The results for such arrangements are shown in \figref{coils-manyMag},
where it can be seen that increasing numbers of magnets initially
increases the force, until the inner radius caused by the shrinking
small magnets causes the force to reduce.

\fxfatal{Wouldn't comparison with equal magnetic volume be more relevant in some ways?}

\begin{figure}
  \begin{subfigure}
    \asyfig{Coil/multimagnet}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath coils-manyMag}
  \end{subfigure}
  \lofcaption{Forces due to a coil on circular arrangements of
    magnets.}{ The outer radius of the magnets is \SI{20}{mm}, and the
    depths of the magnets and coil are \SI{10}{mm} and \SI{10}{mm}
    respectively.}
  \figlabel{coils-manyMag}
\end{figure}

These results are compared to their equivalent ring magnet geometries,
for equivalent inner and outer magnet radius with solid composition. In
\figref{coils-manyMagVerify}, the effect of increasing the inner
radius of a ring magnet is seen to decrease the total force.

\begin{figure}
  \begin{subfigure}
    \asyfig{Coil/ringmagnet}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath coils-manyMagVerify}
  \end{subfigure}
  \lofcaption{Forces due to a coil on various ring magnets.}{ The outer
    radius of the magnets is \SI{20}{mm}, and the depths of the
    magnets and coil are both \SI{10}{mm} respectively.}
  \figlabel{coils-manyMagVerify}
\end{figure}

Greater forces can be achieved by filling in the gaps with smaller
magnets. While great effort could be expended solving an optimal fill
problem, \note{\Eg, ``Kissing Circles: A French romance in MetaPost''
  by Denis
  Roegel:\\\qquad\url{http://www.tug.org/TUGboat/Articles/tb26-1/}} it
is possible to predict the results of asymptotically filling in the
empty space with smaller and smaller magnets: the force would converge
to that achieved with the filled magnet. The impracticalities of
manufactoring such a magnet would also probably increase the expense
prohibitively.

Crudely looking at the problem, application of \eqref{circles} shows
that with six equally spaced magnets in a circle and some small gap
between them, there is just enough space to fit another equally-sized
magnet in the centre. That is, the smallest $n$ for which $3r<R$ is six.

For the double-layer arrangement, the outer magnets need to be small
enough to fit another ring of six equally-sized magnets within them,
which can in turn fit a centre magnet of the same size. For this
problem, with some small gap between the magnets, the smallest $n$ is
twelve.\footnote{\emph{Without} a gap between the magnets, this just
  bumps up to thirteen, but twelve fill the space a little better in
  the centre.} Twelve outer magnets, six inner magnets, and one centre
magnet make nineteen in total.

These filled large-magnet approximations are shown with their force
curves in \figref{coils-gaps}. In the case of six outer magnets, it
can be seen that the inner magnet has little influence on the total
force produced. This echoes the results shown in the eccentricity
forces of \figref{vary-eccentric}, where the forces increased dramatically
when the magnet approached close to the coil. The same would be true
for the nineteen magnet case.

\begin{figure}
  \begin{subfigure}
    \asyfig{Coil/manymagnet}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath coils-gaps}
  \end{subfigure}
  \lofcaption{Forces due to a coil on `filled in' circular arrangements of
    magnets.}{ The outer radius of the magnets is \SI{20}{mm}, and the
    depths of the magnets and coil are both \SI{10}{mm}.}
  \figlabel{coils-gaps}
\end{figure}

\paragraph{Cost considerations}

While greater forces can be obtained from using a single large magnet,
the costs of magnetic material is not proportional to volume. As
example, consider arrangements similar to that shown in
\figref{coils-gaps} for the seven and nineteen magnet constructions,
but omit the centre magnet from each (as it has been shown that the
force due to that one is small compared to the rest).

Appropriate magnets to build these systems have been chosen from K\&J
Magnetics and their approximate prices (without volume discount)
tabulated in \tabref{prices}, based around a nominal large magnet of
diameter \SI{50.8}{mm} and thickness \SI{6.4}{mm}. While exact radii
to fill up the gaps could not be chosen, they are close enough to make
a valid comparison. Significant cost savings on magnetic material can
be made by using these multi-magnet configurations instead of a single
magnet, albeit with a decrease in maximum force and an increase in
construction complexity.

\begin{table}
\caption[Approximate magnet prices.]
{Approximate prices for magnets of thickness \SI{6.4}{mm} that could be used
to construct magnet systems
as shown in \figref{coils-gaps}. Data obtained from
\url{http://www.kjmagnetics.com}, 2007/\textsc{may}/08.}
\tablabel{prices}
\begin{tabular}{@{}cccc@{}}
\toprule
Diameter & Price & Number & Total Price \\
\midrule
\SI{50.8}{mm} & \price{17}   & \num{1}  & \price{17} \\
\SI{15.9}{mm} & \price{1.75} & \num{6}  & \price{10.5} \\
\SI{ 9.5}{mm} & \price{0.70} & \num{18} & \price{12.6} \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Dual coil simulations}
\seclabel{dualcoil}

The $NI/A$ term in the force equation between a magnet and coil has
some interesting effects. The force created by a single layer coil
(that is, $N=1$) cannot be improved upon by adding more layers,
because the total length of wire (and hence the resistance, and the
inverse of current) will grow faster than the linear gains achieved in
the force.

But extra turns of wire are required to achieve a large enough
resistance to be able to drive the coil without overheating it due to
excessive current. It has been shown in the previous section that
increasing the length of a coil is also detrimental to the maximum force
created on a magnet.

A different method of increasing the number of turns is shown here
that does not have the side-effects of effectively reducing the force
that is being generated. By wiring two coils in series and in opposite
winding directions, with the permanent magnet in the gap between them,
greater forces can be achieved than with a single coil of the same
resistance. This design is also better at dissipating heat, as the effective
surface area is greater (or, conversely, it is harder to cool thicker coils).

\begin{figure}
  \asyfig{Coil/dual-coil-single}
  \caption{Dual coil system.}
  \figlabel{dual-coil-schematic}
\end{figure}

For two coils radially aligned with a distance $G$ between their axial
centres, superposition can be used to calculate the forces $F_1$ and
$F_2$ generated between each and a permanent magnet. A schematic of this
system is shown in \figref{dual-coil-schematic}. The axial
distance between the permanent magnet and the two coils is denoted by
$d_1$ and $d_2$. The total force on the magnet is given by
\begin{dmath}
F_{\mathrm{T}}(d_1,d_2)
  =F_1(d_1)+F_2(d_2)
  =F_1(d_1)+F_2(G-d_1)
  =F_1(d_1)-F_1(G-d_1)
\end{dmath}.
The coils are here assumed to be of equal dimension in all
respects. For a fixed dual-coil geometry, this equation allows an
investigation of the force/\-displacement curves while varying the
distance between the coils and the position of the permanent magnet.

Less comprehensive parameter variations are performed to analyse the dual coil
arrangement, as many of the results carry over from the single coil
cases. \Figref{dual-coil} shows a dual-coil design with increasing coil
gaps. The results are evident: if the coils are too far apart, they
act separately and their benefit is not realised; conversely, if they
are too close their effects cancel.

\fxfatal{SHOW THAT THE DUAL COIL IS BETTER!!}

These results follow directly from the single coil simulations. For
optimal coil spacing in the dual coil case, the maximum force position
of a single coil should be used (as in \figref{vary-airgap}) for each
side. \fxfatal{expand}

\begin{figure}
  \begin{subfigure}
    \grf{Figures/Coil/dual-coil-2d_1_0}
  \end{subfigure}\par
  \begin{subfigure}
    \psfragfig{\coilpath 2coils-trial}
  \end{subfigure}
  \caption{Forces between dual-coil/magnet pairs with varying
    inter-coil gap distances. \fxfatal{parameters for the dual coil}}
  \figlabel{dual-coil}
\end{figure}
